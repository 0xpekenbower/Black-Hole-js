[SERVICE]
    flush        5
    daemon       off
    http_server  off
    log_level    info
    parsers_file parsers.conf
    storage.path /var/log/flb-storage/
    workers      8

[INPUT]
    Name        forward
    Listen      0.0.0.0
    Port        24224

[FILTER]
    Name        parser
    Match       *
    Key_Name    log
    Parser      docker
    Reserve_Data true

[FILTER]
    Name        parser
    Match       gateway.*
    Key_Name    log
    Parser      gateway
    Reserve_Data true

[FILTER]
    Name        record_modifier
    Match       *
    Record      hostname ${HOSTNAME}
    Record      environment production



# Send gateway logs directly to Logstash for simple indexing
[OUTPUT]
    Name           tcp
    Match          gateway.*
    Host           logstash
    Port           50000
    Format         json
    # No additional processing needed - Logstash will index directly


# Direct Elasticsearch outputs for other services
[OUTPUT]
    Name           es
    Match          setup.*
    Host           elasticsearch
    Port           9200
    Replace_Dots   on
    Logstash_Format on
    Logstash_Prefix setup
    Include_Tag_Key on
    Tag_Key        setup
    HTTP_User      elastic
    HTTP_Passwd    ${ELASTIC_PASSWORD}
    Suppress_Type_Name on

[OUTPUT]
    Name           es
    Match          nginx.*
    Host           elasticsearch
    Port           9200
    Replace_Dots   on
    Logstash_Format on
    Logstash_Prefix nginx
    Include_Tag_Key on
    Tag_Key        nginx
    HTTP_User      elastic
    HTTP_Passwd    ${ELASTIC_PASSWORD}
    Suppress_Type_Name on

[OUTPUT]
    Name           es
    Match          redis.*
    Host           elasticsearch
    Port           9200
    Replace_Dots   on
    Logstash_Format on
    Logstash_Prefix redis
    Include_Tag_Key on
    Tag_Key        redis
    HTTP_User      elastic
    HTTP_Passwd    ${ELASTIC_PASSWORD}
    Suppress_Type_Name on

[OUTPUT]
    Name           es
    Match          postgres_db.*
    Host           elasticsearch
    Port           9200
    Replace_Dots   on
    Logstash_Format on
    Logstash_Prefix postgres_db
    Include_Tag_Key on
    Tag_Key        postgres_db
    HTTP_User      elastic
    HTTP_Passwd    ${ELASTIC_PASSWORD}
    Suppress_Type_Name on


[OUTPUT]
    Name           es
    Match          pgadmin.*
    Host           elasticsearch
    Port           9200
    Replace_Dots   on
    Logstash_Format on
    Logstash_Prefix pgadmin
    Include_Tag_Key on
    Tag_Key        pgadmin
    HTTP_User      elastic
    HTTP_Passwd    ${ELASTIC_PASSWORD}
    Suppress_Type_Name on


[OUTPUT]
    Name           es
    Match          kafka.*
    Host           elasticsearch
    Port           9200
    Replace_Dots   on
    Logstash_Format on
    Logstash_Prefix kafka
    Include_Tag_Key on
    Tag_Key        kafka
    HTTP_User      elastic
    HTTP_Passwd    ${ELASTIC_PASSWORD}
    Suppress_Type_Name on

# [OUTPUT]
#     Name           es
#     Match          gateway.*
#     Host           elasticsearch
#     Port           9200
#     Replace_Dots   on
#     Logstash_Format on
#     Logstash_Prefix gateway
#     Include_Tag_Key on
#     Tag_Key        gateway
#     HTTP_User      elastic
#     HTTP_Passwd    ${ELASTIC_PASSWORD}
#     Suppress_Type_Name on


[OUTPUT]
    Name           es
    Match          auth.*
    Host           elasticsearch
    Port           9200
    Replace_Dots   on
    Logstash_Format on
    Logstash_Prefix auth
    Include_Tag_Key on
    Tag_Key        auth
    HTTP_User      elastic
    HTTP_Passwd    ${ELASTIC_PASSWORD}
    Suppress_Type_Name on


[OUTPUT]
    Name           es
    Match          chat.*
    Host           elasticsearch
    Port           9200
    Replace_Dots   on
    Logstash_Format on
    Logstash_Prefix chat
    Include_Tag_Key on
    Tag_Key        chat
    HTTP_User      elastic
    HTTP_Passwd    ${ELASTIC_PASSWORD}
    Suppress_Type_Name on


[OUTPUT]
    Name           es
    Match          dash.*
    Host           elasticsearch
    Port           9200
    Replace_Dots   on
    Logstash_Format on
    Logstash_Prefix dash
    Include_Tag_Key on
    Tag_Key        dash
    HTTP_User      elastic
    HTTP_Passwd    ${ELASTIC_PASSWORD}
    Suppress_Type_Name on


[OUTPUT]
    Name           es
    Match          game.*
    Host           elasticsearch
    Port           9200
    Replace_Dots   on
    Logstash_Format on
    Logstash_Prefix game
    Include_Tag_Key on
    Tag_Key        game
    HTTP_User      elastic
    HTTP_Passwd    ${ELASTIC_PASSWORD}
    Suppress_Type_Name on


[OUTPUT]
    Name           es
    Match          frontend.*
    Host           elasticsearch
    Port           9200
    Replace_Dots   on
    Logstash_Format on
    Logstash_Prefix frontend
    Include_Tag_Key on
    Tag_Key        frontend
    HTTP_User      elastic
    HTTP_Passwd    ${ELASTIC_PASSWORD}
    Suppress_Type_Name on